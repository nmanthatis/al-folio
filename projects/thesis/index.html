<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Master Thesis | Nikos Manthatis</title> <meta name="author" content="Nikos Manthatis"/> <meta name="description" content="Nonlinear Control of a Tricopter."/> <meta name="keywords" content="nikolaos-manthatis, mechanical-engineering, control-system, Phd, jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/favicon.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="manthatis.com/projects/thesis/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Nikos</span> Manthatis</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Master Thesis</h1> <p class="post-description">Nonlinear Control of a Tricopter.</p> </header> <article> <h4> Abstract </h4> <p>The current Masters (Diploma) thesis was co-authored with my classmate <a href="mailto:faitsamis@gmail.com">Faidon Tsamis</a> as a part of the <a href="https://lfmt.gr/mpu-rx4/" target="_blank" rel="noopener noreferrer">MPU</a> project. Its subject is the design of a control system for the trajectory tracking of the altitude and the orientation of a tilt-rotor tricopter at the state of hovering. An initial control systen was developed, which is based on the <code class="language-plaintext highlighter-rouge">feedback linearization</code> technique, to achieve the desired error dynamics of the output states. For the disturbance cancellation, the initial control law is augmented with the construction of a <code class="language-plaintext highlighter-rouge">γ-suboptimal controller</code> based on the Bouned Real Lemma.</p> <h4> Modelling </h4> <p>The aerial vehicle is equipped with 5 actuators, in the form of 3 propellers and 2 servo motors. The propellers produce thrust and the servomotors tilt the vector of the thrust produced by the front propellers. As seen in Figure 1 all the forces can be represented on an equivalent triangle, due to the vehicle’s geometry.</p> <div class="row"> <div class="col-sm mt-3 mtmd-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/rx4_free_body_diagram-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/rx4_free_body_diagram-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/rx4_free_body_diagram-1400.webp"></source> <img class="img-fluid rounded" src="/assets/img/rx4_free_body_diagram.jpg" width="auto" height="auto" title="Vehicle Free Body Diagram"> </picture> </figure> </div> </div> <div class="caption"> Fig.1: Free Body Diagram - Forces acted on the equivalent triangle of the aerial vehicle. </div> <p>The tricopter was modelled as a solid non-deformable body. The kinematic and kinetic equations were extracted using euler angles as orientation parametrization. The equations of motion had the form: \begin{gather} m\mathbf{\dot v} =R \sum \mathbf{T}_i + m\mathbf{g}\nonumber \end{gather} \begin{gather} I_G \dot{\omega} = \mathbf{M}_G - {\omega}\times{I_G{\omega}}.\nonumber \end{gather}</p> <p>Where \(v\) and \(\omega\) are translational and rotational velocities and \(T\) and \(M_G\) are forces and moments respectively. As a next step, an \(1-1\) mapping was created to uniquely match the forces and moments to the control variables \(u\). The equation of the system can be written in affine (with respect to the vector of forces and moments \(d = (T, M)^T\) form as follows:</p> <p>\begin{equation} \mathbf{\dot x}= f_0(\mathbf x) + G(\mathbf e)d, \label{affine} \end{equation}</p> <p>where \(x\) the state variables.</p> <p>Each propeller produces thrust (\(T\)) and moment (\(N\)). The two variables are mostly dependent on the rotational speed of the propeller and the air velocity. Their equations can be written as: \begin{equation} T(\omega, V) = \alpha\omega^2 + \beta V^2 \nonumber \end{equation} \begin{equation} N(\omega, V) = \gamma\omega^2 + \delta V^2. \nonumber \end{equation}</p> <p>The parameters \(\alpha, \beta, \gamma, \delta\) were computed using the least squares’ method by approximating the data given by the manufacturer. The results of the approximation for the thrust of a single propeller are given in Figure 2, where data and the approximation surface are plotted.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/ThrustApproximation-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/ThrustApproximation-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/ThrustApproximation-1400.webp"></source> <img class="img-fluid rounded " src="/assets/img/ThrustApproximation.png" width="auto" height="auto" title="Thrust Approximation"> </picture> </figure> </div> </div> <div class="caption"> Fig.2: Thrust Approximation. </div> <p>While our analysis is about hovering, the contribution of the air velocity to the propellers’ load is insignificant. So, we keep only the curve that results from the intersection of the plane \(V=0\) and the approximation surface. To validate our model we measured the produced thrust of propellers. As seen in Figure 3, we used a 10kg loadcell, an Arduino UNO to log the measurements and the necessary equipement that the motor needs to work.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/schematic-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/schematic-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/schematic-1400.webp"></source> <img class="img-fluid rounded z-depth-1" src="/assets/img/schematic.png" width="auto" height="auto" title="example image"> </picture> </figure> </div> </div> <div class="caption"> Fig.3: Thrust Measurung Device diagram. </div> <h4> Experimental Configuration </h4> <p>The resources needed to manufacture an original MPU aerial vehicle led to the <strong>design</strong> and <strong>construction</strong> of an inexpensive and easily repairable experimental device. The design was done with Autodesk Inventor and aluminium and 3D printed PLA were used as building materials. A tricopter in “T” shape was designed that adequately reproduces the function of the original vehicle. In Figure 4 an intersection of the tilting mechanism is presented.</p> <div class="row justify-content-sm-center"> <div class="col-sm-7 mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/skoupa_mech-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/skoupa_mech-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/skoupa_mech-1400.webp"></source> <img class="img-fluid rounded " src="/assets/img/skoupa_mech.png" width="auto" height="auto" title="Tilting Mechanism"> </picture> </figure> </div> </div> <div class="caption"> Fig.4: Tilting Mechanism intersection and exploded view. </div> <p>The full assembly can be seen in Figure 5, where the rendered and the constructed test beds are presented. The experimental configuration constists of 3 pairs of motor-propeller-ESC, 2 servomotors, a LiPo battery and the <a href="https://docs.px4.io/v1.12/en/flight_controller/pixhawk-2.html" target="_blank" rel="noopener noreferrer">Pixhawk flight controller</a>.</p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/Skoupa_render-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/Skoupa_render-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/Skoupa_render-1400.webp"></source> <img class="img-fluid rounded " src="/assets/img/Skoupa_render.png" width="auto" height="auto" title="Tricopter Render"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/skoupa_real-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/skoupa_real-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/skoupa_real-1400.webp"></source> <img class="img-fluid rounded z-depth-1" src="/assets/img/skoupa_real.png" width="auto" height="auto" title="Tricopter Manufactured"> </picture> </figure> </div> </div> <div class="caption"> Fig.5: Designed and Manufactured Experimental Configuration. </div> <h4> Non Linear Controller </h4> <p>The developed control law aims at the autonomous hovering and the trajectory tracking of the tricopter. Firstly, a non-linear control law is composed that utilizes feedback linearization to impose the desired first order error dynamics on the state variables. Moreover, taking into consideration the constant and variable disturbancies of the system, γ-suboptimal control is being used. The mathematics around the proecess of the control development are going to be presented simplistically in order to fit with the context of the website.</p> <p>Consider the affine system (\ref{affine}) and we are selecting a set of forces (input variable \(d\)) that casts away the non linear term \(f_0\) so we can impose our desired dynamics. Let the desired vector \(x_d\), if we select \(d\) to be \(d = G(e)^{-1}(-f_0(x) + K(x - x_d) + \dot{x}_d)\) then our system will become \begin{equation} \dot{x} = f_o(x) + G(e)G(e)^{-1}(-f_0(x) + K(x - x_d) + \dot{x}_d) \Rightarrow \nonumber \end{equation} \begin{equation} \dot{x} = K(x - x_d) + \dot{x}_d \nonumber \end{equation} letting \(\widetilde{x} = x - x_d\) \begin{equation} \dot{\widetilde{x}} = K\widetilde{x}. \nonumber \end{equation}</p> <p>This way we constructed the first order error dynamics to our system. Next we tune our controller by choosing the matrix \(K\) that satisfies the needs of our application. In the next figure we observe the step response for the output vector.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/fig_testeig-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/fig_testeig-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/fig_testeig-1400.webp"></source> <img class="img-fluid rounded " src="/assets/img/fig_testeig.png" width="auto" height="auto" title="Step Response of output variables"> </picture> </figure> </div> </div> <div class="caption"> Fig.6: Step Response of output variables. </div> <p>Figure 6 depicts the time constants as black dots that our tuning suceeds. Then we are testing our control law to a possible scenario which is to reach a altitidue of \(30m\) and have a defined heading of \(50^{\circ}\) to the north pole while having non-zero initial orientation. This is a possible mission for the tricopter as it is getting the pose to continue flying as a regural plane.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/fig_sigmoid_1-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/fig_sigmoid_1-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/fig_sigmoid_1-1400.webp"></source> <img class="img-fluid rounded " src="/assets/img/fig_sigmoid_1.png" width="auto" height="auto" title="Scenario 1"> </picture> </figure> </div> &lt;<div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/fig_sigmoid_2-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/fig_sigmoid_2-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/fig_sigmoid_2-1400.webp"></source> <img class="img-fluid rounded " src="/assets/img/fig_sigmoid_2.png" width="auto" height="auto" title="Scenario 1"> </picture> </figure> </div> </div> </div> <div class="caption"> Fig.6: Flight Scenario. </div> <p>At Figure 6 we see that our control law achieves the desired outcome (top) by not exceeding the actuator limits (\(\omega_i, \theta_i\)).</p> <p>You can download the thesis (in Greek) <a href="/assets/pdf/manthatis_thesis.pdf">here</a>.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2022 Nikos Manthatis. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Last updated: November 18, 2022. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script type="text/javascript">$(function(){$('[data-toggle="tooltip"]').tooltip()});</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>